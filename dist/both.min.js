/*
 *  both - v0.6.0
 *  detects in real time user interaction type (mouse, touch or keyboard) and switches linked events
 *  https://github.com/idomusha/both
 *
 *  Made by idomusha
 *  Under MIT License
 */
!function(a,b,c,d){"use strict";function e(c){this._name=f,this._defaults=b[f].defaults,this.settings=a.extend({},this._defaults,c),this._debug=this.settings.debug,this._debug&&console.log("defaults",this._defaults),this._debug&&console.log("settings",this.settings),this.init()}var f="Both";a.extend(e.prototype,{init:function(){var a=this;a._debug&&console.log("##################### init()"),a.buildCache(),a.types=[],a.touch=!1,a.mouse=!1,a.keyboard=!1,a.handlersData={mouse:[],touch:[],key:[]},a.inputs=["input","select","textarea"],a.keys={9:"tab",13:"enter",16:"shift",27:"esc",32:"space",37:"left",38:"up",39:"right",40:"down"},a._debug&&console.log("device:",a.settings.device),"mobile"==a.settings.device||"tablet"==a.settings.device?a.set("touch",!0):a.set("mouse",!0),a.bindEvents()},destroy:function(){var a=this;a.unbindEvents(),a.window.removeData()},buildCache:function(){this.document=a(c),this.$html=a("html")},bindEvents:function(){var a=this;a._debug&&console.log("##################### bindUIActions()");var b;a.document.on("mousemove."+a._name,function(c){if(a._debug&&console.log(">>> mousemove"),!(a.types.indexOf("mouse")>-1)){if(a._debug&&console.log("_touchstart",b),b)return void(b=!1);a.set.call(a,"mouse",c),a.handleInteractionTypeChange(c)}}),a.document.on("touchstart."+a._name,function(c){a._debug&&console.log(">>> touchstart"),b=!0,a.types.indexOf("touch")>-1||(a.set("touch",c),a.handleInteractionTypeChange(c))}),a.document.on("keydown."+a._name,function(b){a.check.call(a,b)})},unbindEvents:function(){var a=this;a.document.off("mousemove."+a._name),a.document.off("touchstart."+a._name)},check:function(a){var b=this;b._debug&&console.log("##################### check()",a),b._debug&&console.log("event.type:",a.type),"tab"!==b.keys[b.key(a)]&&b.inputs.indexOf(b.target(a).nodeName.toLowerCase())>=0||(b.set("keyboard",a),b.handleInteractionTypeChange(a))},set:function(a,b){var c=this;c._debug&&console.log("##################### set()",a),"mouse"==a?(c.keyboard=!1,c.touch=!1,c.mouse=!0,c._array.remove(c.types,"keyboard"),c._array.remove(c.types,"touch"),c._array.add(c.types,"mouse")):"touch"==a?(c.keyboard=!1,c.touch=!0,c.mouse=!1,c._array.remove(c.types,"keyboard"),c._array.remove(c.types,"mouse"),c._array.add(c.types,"touch")):"keyboard"==a&&(c.mouse=!1,c.touch=!1,c.keyboard=!0,c._array.remove(c.types,"mouse"),c._array.remove(c.types,"touch"),c._array.add(c.types,"keyboard")),c._debug&&console.log("types:",c.types),c.$html.attr("data-interaction",a)},key:function(a){return a.keyCode?a.keyCode:a.which},target:function(a){return a.target||a.srcElement},start:function(){this.handleInteractionTypeChange(!0)},handleInteractionTypeChange:function(a){var b=this,c="boolean"==typeof a&&a?"is setted":"has changed";b._debug&&console.log("---------------------------------------------------"),b._debug&&console.log("Interaction type "+c+": "+b.types.toString()),b._debug&&console.log("---------------------------------------------------"),b["switch"]()},store:function(a,b,c,d){var e=this;e._debug&&console.log("##################### store()"),e._debug&&console.log("- context",a),e._debug&&console.log("- selector",b),e._debug&&console.log("- event",c),e._debug&&console.log("- handler",d),e._array.add(e.handlersData[a],{selector:b,event:c,handler:d}),e._debug&&console.log("handlersData",e.handlersData),null!=e.interval&&clearInterval(this.interval),e.timer=0,e.interval=setInterval(function(){1==e.timer&&(e.start.call(e),clearInterval(e.interval),e.interval=null),e.timer++}.bind(e),100)},lose:function(a,b,c){var d=this;d._debug&&console.log("##################### lose()"),d._debug&&console.log("- context",a),d._debug&&console.log("- selector",b.selector),d._debug&&console.log("- event",c);for(var e=0;e<d.handlersData[a].length;e++)d.handlersData[a][e].selector.selector===b.selector&&d.handlersData[a][e].event===c&&(d.handlersData[a][e].selector.off(d.handlersData[a][e].event,d.handlersData[a][e].handler),d._array.remove(d.handlersData[a],d.handlersData[a][e]),e--)},"switch":function(){var a=this;a._debug&&console.log("##################### switch()");var b={on:a.types.indexOf("mouse")>-1?"mouse":"touch",off:a.types.indexOf("mouse")>-1?"touch":"mouse"};a._debug&&console.log(a.types),a.on(b.on),a.off(b.off)},on:function(a){var b=this;b._debug&&console.log("##################### on()");for(var c=0;c<b.handlersData[a].length;c++){var d={selector:b.handlersData[a][c].selector,event:b.handlersData[a][c].event,handler:b.handlersData[a][c].handler};d.selector.on(d.event,d.handler)}},off:function(a){var b=this;b._debug&&console.log("##################### off()");for(var c=0;c<b.handlersData[a].length;c++){var d={selector:b.handlersData[a][c].selector,event:b.handlersData[a][c].event,handler:b.handlersData[a][c].handler};d.selector.off(d.event,d.handler)}},_array:{add:function(a,b){this._debug&&console.log("##################### array.add()"),a.push(b)},remove:function(a,b){this._debug&&console.log("##################### array.remove()");var c=a.indexOf(b);c>-1&&a.splice(c,1)}},refresh:function(){this._debug&&console.log("##################### refresh()")}}),b[f]=function(c){a.data(b,f)||a.data(b,f,new e(c))},b[f].defaults={device:"",interval:200,debug:!1}}(jQuery,window,document);